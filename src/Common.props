<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup Label="UserMacros">
    <MQ2SolutionDirectory>$(MSBuildThisFileDirectory)</MQ2SolutionDirectory>
    <MQ2BinaryDirName Condition="'$(Configuration)'=='Debug'">debug</MQ2BinaryDirName>
    <MQ2BinaryDirName Condition="'$(Configuration)'=='Release'">release</MQ2BinaryDirName>
    <MQ2Root>$(MQ2SolutionDirectory)..\</MQ2Root>
    <MQ2BuildDirectory>$(MQ2Root)build\</MQ2BuildDirectory>

    <!-- vcpkg paths -->
    <VCPKG_IncludeDirs>$(MQ2Root)contrib\vcpkg\installed\x86-windows-static\include</VCPKG_IncludeDirs>
    <VCPKG_LibraryDirs Condition="'$(Configuration)'=='Debug'">$(MQ2Root)contrib\vcpkg\installed\x86-windows-static\debug\lib</VCPKG_LibraryDirs>
    <VCPKG_LibraryDirs Condition="'$(Configuration)'=='Release'">$(MQ2Root)contrib\vcpkg\installed\x86-windows-static\lib</VCPKG_LibraryDirs>
  </PropertyGroup>
  <PropertyGroup>
    <IntDir>$(MQ2BuildDirectory)obj\$(MQ2BinaryDirName)\$(ProjectName)\</IntDir>
    <OutDir>$(MQ2BuildDirectory)bin\$(MQ2BinaryDirName)\</OutDir>
    <LinkIncremental Condition="'$(Configuration)'=='Debug'">true</LinkIncremental>
    <LinkIncremental Condition="'$(Configuration)'=='Release'">false</LinkIncremental>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <!-- Debug only compiler settings props-->
    <ClCompile Condition="'$(Configuration)'=='Debug'">
      <Optimization>Disabled</Optimization>
      <InlineFunctionExpansion>Disabled</InlineFunctionExpansion>
      <PreprocessorDefinitions>_DEBUG;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
      <BufferSecurityCheck>false</BufferSecurityCheck>
      <FunctionLevelLinking>true</FunctionLevelLinking>
    </ClCompile>
    <!-- Release only compiler settings -->
    <ClCompile Condition="'$(Configuration)'=='Release'">
      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
      <StringPooling>true</StringPooling>
      <BufferSecurityCheck>false</BufferSecurityCheck>
      <FunctionLevelLinking>true</FunctionLevelLinking>
    </ClCompile>
    <!-- Shared compiler settings -->
    <ClCompile>
      <AdditionalIncludeDirectories>$(MQ2Root)include;$(MQ2Root)contrib;$(MQ2Root)contrib\date\include;$(MQ2Root)contrib\fmt\include;$(MQ2Root)contrib\wil\include;$(MQ2Root)contrib\spdlog\include;$(MQ2Root)contrib\imgui;$(MQ2Root)contrib\imgui\misc\cpp;$(MQ2Root)contrib\mini-yaml\yaml;$(MQ2Root)contrib\tinyfsm\include;$(MQ2Root)src;$(VCPKG_IncludeDirs);$(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
      <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>
      <WarningLevel>Level3</WarningLevel>
      <CompileAs>CompileAsCpp</CompileAs>
      <MultiProcessorCompilation>true</MultiProcessorCompilation>
      <LanguageStandard>stdcpp17</LanguageStandard>
      <PreprocessorDefinitions>_SILENCE_CXX17_CODECVT_HEADER_DEPRECATION_WARNING;WIN32_LEAN_AND_MEAN;NOMINMAX;_WINNT_WIN32=0x0601;WINVER=0x0601;%(PreprocessorDefinitions)</PreprocessorDefinitions>
    </ClCompile>
    <!-- Debug only linker settings -->
    <Link Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    </Link>
    <!-- Release only linker settings -->
    <Link Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    </Link>
    <!-- Shared linker settings -->
    <Link Condition="'$(Platform)'=='Win32'">
      <AdditionalDependencies>winmm.lib;%(AdditionalDependencies)</AdditionalDependencies>
      <AdditionalLibraryDirectories>$(MQ2Root)contrib\detours\lib;$(VCPKG_LibraryDirs);$(OutDir);%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
      <GenerateDebugInformation>true</GenerateDebugInformation>
      <SubSystem>Windows</SubSystem>
      <ImageHasSafeExceptionHandlers>false</ImageHasSafeExceptionHandlers>
      <OptimizeReferences>false</OptimizeReferences>
      <EnableCOMDATFolding>false</EnableCOMDATFolding>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup />
  <Target Name="VcpkgMQInstallManifestDependencies" BeforeTargets="ClCompile">
    <Message Text="Checking vcpkg_mq manifest for $(MSBuildProjectName)..." Importance="High" />
    <Exec Command="if exist %22$([MSBuild]::GetDirectoryNameOfFileAbove($(MSBuildProjectDirectory), tools\build_scripts\vcpkg_mq.ps1))\tools\build_scripts\vcpkg_mq.ps1%22 powershell.exe -ExecutionPolicy Bypass -NoProfile -NonInteractive -File %22$([MSBuild]::GetDirectoryNameOfFileAbove($(MSBuildProjectDirectory), tools\build_scripts\vcpkg_mq.ps1))\tools\build_scripts\vcpkg_mq.ps1%22 -ProjectName %22$(MSBuildProjectName)%22 -ProjectDirectory %22$(MSBuildProjectDirectory)%22 -MQRoot %22$(MQ2Root.TrimEnd('\'))%22" StandardOutputImportance="High" />
  </Target>
</Project>